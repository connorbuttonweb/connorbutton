<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Portfolio | Pines Projects</title>
  <link rel="stylesheet" href="main.css" />
  <style>
    /* Minimal page-specific styles: lightbox + small enhancements */
    .page-title { margin: 0 0 0.5rem; }
    .page-subtitle { margin: 0 0 1.5rem; color: var(--muted); }

    /* Use the global .gallery styles from main.css. Add click affordances only. */
    .gallery figure{
      position: relative;
      cursor: zoom-in;
      border-radius: var(--radius);
      overflow: hidden;
    }
    .gallery img, .gallery video{ display:block; width:100%; height:100%; object-fit:cover; }

    .media-badge{
      position: absolute;
      right: 10px; bottom: 10px;
      font-size: 12px; padding: 4px 8px;
      border-radius: 999px;
      background: rgba(0,0,0,0.6);
      color:#fff; backdrop-filter: blur(3px);
      user-select:none; pointer-events:none;
    }

    /* Lightbox overlay */
    .lightbox {
      position: fixed; inset: 0;
      display: none; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.9);
      z-index: 9999;
    }
    .lightbox.open { display: flex; }
    .lightbox-content {
      position: relative;
      max-width: 95vw; max-height: 92vh; width: min(1100px, 95vw);
      display:flex; align-items:center; justify-content:center;
    }
    .lightbox img, .lightbox video {
      max-width: 100%; max-height: 92vh; width: auto; height:auto;
      border-radius: 12px;
      outline: 1px solid rgba(255,255,255,0.15);
      background:#000;
    }
    .lightbox .close,
    .lightbox .prev,
    .lightbox .next {
      position: absolute; top: 50%; transform: translateY(-50%);
      border: 0; background: rgba(255,255,255,0.12); color: #fff;
      padding: 0.65rem 0.8rem; border-radius: 10px; cursor: pointer; font-weight: 700;
    }
    .lightbox .close { top: 2%; right: 2%; transform: none; }
    .lightbox .prev { left: 1.2%; }
    .lightbox .next { right: 1.2%; }
    .lightbox .close:hover, .lightbox .prev:hover, .lightbox .next:hover{
      background: rgba(255,255,255,0.22);
    }
    .caption {
      margin-top: 0.75rem;
      text-align: center;
      color: #f0f0f0;
      font-size: 0.95rem;
      opacity: 0.85;
      max-width: min(900px, 90vw);
    }
  </style>
</head>

<script>
(function () {
  // 1) Images: eager-load the first couple above the fold; lazy-load the rest
  const imgs = Array.from(document.querySelectorAll('img'));
  imgs.forEach((img, i) => {
    if (i < 2) {                 // first two images on the page
      img.loading = 'eager';
      img.fetchPriority = 'high';
    } else {
      img.loading = 'lazy';
      img.decoding = 'async';
      img.fetchPriority = 'low';
    }
  });

  // 2) Videos: don’t download until needed, and pause when off-screen
  const vids = document.querySelectorAll('video');
  vids.forEach(v => { v.preload = 'none'; });

  const iv = new IntersectionObserver((entries) => {
    entries.forEach(({isIntersecting, target:v}) => {
      if (!isIntersecting && !v.paused) v.pause();
    });
  }, { threshold: 0.1 });
  vids.forEach(v => iv.observe(v));

  // 3) Lightbox thumbnails: (already using smaller thumbs)
  // Make sure full-res loads ONLY when opened (your existing lightbox does this).
})();
</script>

<body>
  <div class="back-btn">
    <a href="index.html">← Back to Home</a>
  </div>

  <section class="section">
    <div class="container">
      <div style="display: flex; align-items: center; gap: 12px; flex-wrap: wrap;">
  <img src="images/PinesLogo.webp" alt="Pines Logo" style="height: 60px; width: auto;" />
  <h1 class="page-title" style="margin:0;">Pines Project Portfolio</h1>
      </div>

      <p class="page-subtitle">
        The following are only the projects I have personally led. For more Pines projects visit Pines Landscaping through their website or on instagram
      </p>
      <div class="cta-row" style="margin: 16px 0;">
        <a class="btn primary" href="https://pineslandscaping.ca/" target="_blank" rel="noopener">Website</a>
        <a class="btn ghost" href="https://www.instagram.com/thepinesgroup/?hl=en" target="_blank" rel="noopener">Instagram</a>
      </div>

      <!-- Team photo directly under the subtitle -->
      <div style="margin: 20px 0; text-align: center;">
        <img src="images/TeamPhoto.jpg" alt="Pines Team" style="max-width:100%; border-radius:12px; box-shadow:0 6px 16px rgba(0,0,0,0.08);" />
      </div>

      <!-- ===== Landry ===== -->
      <section class="job-block" aria-labelledby="job1">
        <h2 id="job1">134 Landry Ln | 16 Unit Condominium</h2>
        <p class="small">The complete construction of the front and back entrances to the 16-unit neighbourhood. Planting of 36 mature trees and front gardens for all units, with the engineered grading of the whole property. Drainage piping, electrical conduit, and communication cable were run throughout the entire property prior to asphalt and grading. The project finished on schedule, with praise from the developer and condo owners. This is a property that still to this day, Pines maintains and is proud to show off to prospective clients.</p>
        <div class="gallery" data-gallery="job1">
          <!-- Replace src paths with your real files in /images/... -->
          <figure data-type="image" data-src="images/Landry1.jpg">
            <img loading="lazy" src="images/Landry1.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Landry2.jpg">
            <img loading="lazy" src="images/Landry2.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Landry3.jpg">
            <img loading="lazy" src="images/Landry3.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Landry4.jpg">
            <img loading="lazy" src="images/Landry4.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Landry5.jpg">
            <img loading="lazy" src="images/Landry5.jpg" />
          </figure>
        </div>
      </section>

      <!-- ===== Twin Peaks ===== -->
      <section class="job-block" aria-labelledby="job2">
        <h2 id="job2">The Twin Peaks | Outdoor Wet-Lay Patio</h2>
        <p class="small">On Grey Rd 40 I oversaw the complete renovation of a 5500 sq ft outdoor porcelain patio at a property dubbed “The Twin Peaks”. The chipping away of the old patio, as well as the grinding down of the old mortar and concrete bed, gave way to many challenges. This was compounded by consistent 40km/h winds that routinely tore down the tarped structure we had built to keep us dry and warm in the February and March cold. Overall, the project was extremely successful, but one that the crew and I don’t look back on very fondly.</p>
        <div class="gallery" data-gallery="job2">
          <figure data-type="image" data-src="images/TwinPeaks1.jpg">
            <img loading="lazy" src="images/TwinPeaks1.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/TwinPeaks2.jpg">
            <img loading="lazy" src="images/TwinPeaks2.jpg"/>
          </figure>
          <figure
            data-type="video"
            data-src="images/TwinPeaksVideo.mp4"
            data-poster="images/TwinPeaksVidPost.jpg">
            <video muted preload="metadata" src="images/TwinPeaksVideo.mp4" poster="images/TwinPeaksVidPost.jpg"></video>
            <span class="media-badge">Video</span>
          </figure>
        </div>
      </section>

      <!-- ===== Singhampton Pool ===== -->
      <section class="job-block" aria-labelledby="job3">
        <h2 id="job3">Clarks Pools - Singhampton | Pool Excavation, patio's, fencing & more</h2>
        <p class="small">In Singhampton we were contracted by Clarks Pools to complete the excavation and patios surrounding a concrete in ground pool. In Addition to this was an outdoor shower, fencing, and a sunken patio by the house. This project was completed smoothly, with the only strain being digging in such rocky ground. The photos highlight how much work gets done in a small period, with the total length of the project being completed in just 3 weeks.</p>
        <div class="gallery" data-gallery="job3">
          <figure data-type="image" data-src="images/Clarks1.jpg">
            <img loading="lazy" src="images/Clarks1.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/Clarks2.jpg">
            <img loading="lazy" src="images/Clarks2.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/Clarks3.jpg">
            <img loading="lazy" src="images/Clarks3.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/Clarks4.jpg">
            <img loading="lazy" src="images/Clarks4.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/Clarks5.jpg">
            <img loading="lazy" src="images/Clarks5.jpg"/>
          </figure>
          <figure data-type="image" data-src="images/Clarks6.jpg">
            <img loading="lazy" src="images/Clarks6.jpg"/>
          </figure>
        </div>
      </section>

      <!-- ===== Bishops ===== -->
      <section class="job-block" aria-labelledby="job1">
        <h2 id="job1">Poplar Patios | Naturel Stone Walkways, Drainage & Grading</h2>
        <p class="small">I completed a non-invasive project installing naturel stone stepping and walkways on a property near Osler Ski Club. With quick turn around, we re-graded low spots of their lawn, buried their downspouts, and installed steps and walkways on the front, back, and side entrances. Right before completion, the hydraulic line burst on our excavator causing us to re-lay the front walkway. What was thought to be a project ruining mistake, was fixed in less then half a day with quick planning and expertise.</p>
        <div class="gallery" data-gallery="job1">
          <!-- Replace src paths with your real files in /images/... -->
          <figure data-type="image" data-src="images/Bishop1.jpg">
            <img loading="lazy" src="images/Bishop1.jpeg" />
          </figure>
          <figure data-type="image" data-src="images/Bishop2.jpg">
            <img loading="lazy" src="images/Bishop2.jpg" />
          </figure>
        </div>
      </section>

      <!-- ===== Watsons ===== -->
      <section class="job-block" aria-labelledby="job1">
        <h2 id="job1">Goldie Cres | Paver Driveway, Artificial Turf, Patios & Lighting</h2>
        <p class="small"></p>
        <div class="gallery" data-gallery="job1">
          <!-- Replace src paths with your real files in /images/... -->
          <figure data-type="image" data-src="images/Goldie1.jpg">
            <img loading="lazy" src="images/Goldie1.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Goldie2.jpg">
            <img loading="lazy" src="images/Goldie2.jpg" />
          </figure>
          <figure data-type="image" data-src="images/Goldie3.jpg">
            <img loading="lazy" src="images/Goldie3.jpg" />
          </figure>
        </div>
      </section>
    </div>
  </section>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="Media viewer">
    <div class="lightbox-content" id="lbContent" tabindex="0" aria-live="polite"></div>
    <button class="close" id="lbClose" aria-label="Close (Esc)">✕</button>
    <button class="prev" id="lbPrev" aria-label="Previous (←)">⬅</button>
    <button class="next" id="lbNext" aria-label="Next (→)">➡</button>
    <p class="caption" id="lbCaption"></p>
  </div>

  <script>
    // Vanilla JS lightbox supporting images & videos, with arrow keys and ESC.
    (function(){
      const galleries = Array.from(document.querySelectorAll('.gallery'));
      const lightbox = document.getElementById('lightbox');
      const lbContent = document.getElementById('lbContent');
      const lbCaption = document.getElementById('lbCaption');
      const btnPrev = document.getElementById('lbPrev');
      const btnNext = document.getElementById('lbNext');
      const btnClose = document.getElementById('lbClose');

    // Collect all figure elements inside .gallery
    const media = [];
    galleries.forEach(g => {
      const tiles = Array.from(g.querySelectorAll('figure'));
      tiles.forEach(t => media.push({
        el: t,
        gallery: g.dataset.gallery || 'gallery',
        type: t.dataset.type || (t.querySelector('video') ? 'video' : 'image'),
        // allow multiple sources via CSV; fall back to the element src
        src: (t.dataset.src
                ? t.dataset.src.split(',').map(s => s.trim()).filter(Boolean)
                : [t.querySelector('img,video')?.getAttribute('src')].filter(Boolean)),
        poster: t.dataset.poster || t.querySelector('video')?.getAttribute('poster') || '',
        caption: t.dataset.caption || t.querySelector('img')?.getAttribute('alt') || ''
      }));
    });


      let currentIndex = -1;

      function openAt(index){
        if(index < 0 || index >= media.length) return;
        currentIndex = index;
        renderMedia(media[currentIndex]);
        lightbox.classList.add('open');
        document.body.style.overflow = 'hidden';
        lbContent.focus();
      }

      function close(){
        lightbox.classList.remove('open');
        document.body.style.overflow = '';
        stopActiveVideo();                 // fully stop/unload any playing video
        lbContent.innerHTML = '';
        lbCaption.textContent = '';
      }

      // Unload any active <video> in the lightbox
      function stopActiveVideo(){
        const v = lbContent.querySelector('video');
        if (v){
          try { v.pause(); } catch(_) {}
          // Remove sources so audio can’t keep playing on some mobiles
          v.removeAttribute('src');
          // Also clear <source> children if present
          v.querySelectorAll('source').forEach(s => s.remove());
          v.load();
        }
      }

      function prev(){ stopActiveVideo(); openAt((currentIndex - 1 + media.length) % media.length); }
      function next(){ stopActiveVideo(); openAt((currentIndex + 1) % media.length); }

      function renderMedia(item){
        stopActiveVideo();
        lbContent.innerHTML = '';

        if (item.type === 'video'){
          const v = document.createElement('video');
          v.controls = true;
          v.playsInline = true;
          v.preload = 'metadata';         // lighter than 'auto'
          if (item.poster) v.poster = item.poster;
          v.style.maxHeight = '92vh';

          // Accept one or many sources (from data-src CSV)
          const sources = Array.isArray(item.src) ? item.src : [item.src];
          sources.forEach(src => {
            const s = document.createElement('source');
            s.src = src;
            s.type = src.endsWith('.webm') ? 'video/webm' : 'video/mp4';
            v.appendChild(s);
          });

          lbContent.appendChild(v);
          // Try to start muted (mobile-safe). If it fails, user can tap play.
          v.muted = true;
          v.play().catch(()=>{});
        } else {
          const img = document.createElement('img');
          img.src = Array.isArray(item.src) ? item.src[0] : item.src;
          img.alt = item.caption || 'Expanded image';
          img.style.maxHeight = '92vh';
          lbContent.appendChild(img);
        }

        lbCaption.textContent = item.caption || '';
      }

      // Click handlers + keyboard activation for accessibility
      media.forEach((m, idx) => {
        m.el.addEventListener('click', () => openAt(idx));
        m.el.setAttribute('tabindex', '0');
        m.el.setAttribute('role', 'button');
        m.el.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' '){
            e.preventDefault();
            openAt(idx);
          }
        });
      });

      btnClose.addEventListener('click', close);
      btnPrev.addEventListener('click', prev);
      btnNext.addEventListener('click', next);

      // Close when clicking on overlay background
      lightbox.addEventListener('click', (e) => { if(e.target === lightbox) close(); });

      // Keyboard controls
      document.addEventListener('keydown', (e) => {
        if(!lightbox.classList.contains('open')) return;
        if(e.key === 'Escape') close();
        else if(e.key === 'ArrowLeft') prev();
        else if(e.key === 'ArrowRight') next();
      });
    })();


          // Swipe (mobile)
      let touchStartX = null;
      lightbox.addEventListener('touchstart', e => {
        touchStartX = e.changedTouches[0].clientX;
      }, { passive: true });

      lightbox.addEventListener('touchend', e => {
        if (touchStartX === null) return;
        const dx = e.changedTouches[0].clientX - touchStartX;
        if (Math.abs(dx) > 50) { dx > 0 ? prev() : next(); }
        touchStartX = null;
      }, { passive: true });
  </script>
</body>
</html>
